var start=function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=24)}([function(t,e,n){var r=n(1),i={};i[r.Boolean]=n(29),i[r.UInt2]=n(30),i[r.UInt3]=n(31),i[r.UInt4]=n(32),i[r.UInt5]=n(33),i[r.UInt6]=n(34),i[r.UInt7]=n(35),i[r.UInt8]=n(12),i[r.UInt9]=n(36),i[r.UInt10]=n(37),i[r.UInt11]=n(38),i[r.UInt12]=n(39),i[r.UInt16]=n(40),i[r.UInt32]=n(41),i[r.Int4]=n(42),i[r.Int6]=n(43),i[r.Int8]=n(44),i[r.Int10]=n(45),i[r.Int16]=n(46),i[r.Int32]=n(47),i[r.Float32]=n(48),i[r.Float64]=n(49),i[r.EntityId]=n(50),i[r.Rotation8]=n(51),i[r.RotationFloat32]=n(52),i[r.RGB888]=n(53),i[r.ASCIIString]=n(54),i[r.UTF8String]=n(55),i.countBits=function(t,e){var n=i[t.type];if(t.isArray){var r=0;return r+=i[t.arrayIndexBinaryType].bits,n.customBits?r+=n.countBits(e)*e.length:r+=n.bits*e.length,r}return n.customBits?n.countBits(e):n.bits},t.exports=i},function(t,e){var n=function(t){for(var e={},n=0;n<t.length;n++)e[t[n]]=n;return e}(["Null","Boolean","UInt2","UInt3","UInt4","UInt5","UInt6","UInt7","UInt8","UInt9","UInt10","UInt11","UInt12","UInt16","UInt32","Int4","Int6","Int8","Int10","Int16","Int32","Float32","Float64","EntityId","Rotation8","ASCIIString","UTF8String","RGB888"]);t.exports=n},function(t,e){t.exports=function(t,e){var n=Math.floor(t),r=Math.floor(e);return{a:n,b:r,isChanged:n!==r}}},function(t,e,n){var r={},i=n(1);r.Boolean=i.Boolean,r.Int2=i.Int2,r.UInt2=i.UInt2,r.Int3=i.Int3,r.UInt3=i.UInt3,r.Int4=i.Int4,r.UInt4=i.UInt4,r.Int6=i.Int6,r.UInt6=i.UInt6,r.Int8=i.Int8,r.UInt8=i.UInt8,r.Int10=i.Int10,r.UInt10=i.UInt10,r.Int12=i.Int12,r.UInt12=i.UInt12,r.Int16=i.Int16,r.UInt16=i.UInt16,r.Int32=i.Int32,r.UInt32=i.UInt32,r.Float32=i.Float32,r.Number=r.Float64=i.Float64,r.EntityId=i.EntityId,r.RGB888=i.RGB888,r.ASCIIString=i.ASCIIString,r.String=r.UTF8String=i.UTF8String,r.Basic=r.Protocol=n(5),r.Entity=r.EntityProtocol=n(14),r.LEvent=r.LocalEventProtocol=n(15),r.Msg=r.Message=r.MessageProtocol=n(16),r.Command=r.CommandProtocol=n(17),r.Client=n(56),r.Interpolator=n(96),t.exports=r},function(t,e,n){var r={};n(1).UInt8;var i=function(t){for(var e={},n=0;n<t.length;n++){var i=t[n];e[i]=n,r[n]=i}return e}(["ClientTick","Ping","Pong","Timesync","CreateEntities","UpdateEntitiesPartial","UpdateEntitiesOptimized","DeleteEntities","CreateComponents","UpdateComponentsPartial","UpdateComponentsOptimized","DeleteComponents","Messages","LocalEvents","Commands","JSONs","TransferClient","TransferRequest","TransferResponse","Handshake","ConnectionResponse","Engine"]);t.exports.ChunkReverse=r,t.exports.Chunk=i},function(t,e,n){var r=n(26),i=n(27),o=n(28);t.exports=function(t,e,n,s,a){this.metaType="protocol",this.type="basic",this.properties={},this.keys=[],this.hasOptimizations=!1;var p=[];for(var c in t[e.TYPE_PROPERTY_NAME]&&p.push(e.TYPE_PROPERTY_NAME),t[e.ID_PROPERTY_NAME]&&p.push(e.ID_PROPERTY_NAME),t)c!==e.TYPE_PROPERTY_NAME&&c!==e.ID_PROPERTY_NAME&&p.push(c);this.keyType=o(p.length);for(var h=0;h<p.length;h++){var u=t[c=p[h]];if(this.properties[c]=r(h,u,a),this.keys.push(c),-1!==c.indexOf(".")){if(this.properties[c].path=c.split("."),this.properties[c].path.length>3)throw new Error("Protocol nested property limit (3 maximum) exceeded by path "+t+" "+n)}else this.properties[c].path=[c]}if(void 0!==n){var l={properties:{},keys:[]},f=[];for(var c in n)f.push(c);for(h=0;h<f.length;h++){var d=n[c=f[h]];if(l.properties[c]=i(h,d),l.keys.push(c),-1!==c.indexOf(".")){if(l.properties[c].path=c.split("."),l.properties[c].path.length>3)throw new Error("Protocol nested property limit (3 maximum) exceeded by path "+t+" "+n)}else l.properties[c].path=[c]}this.hasOptimizations=!0,this.batch=l}this.components=!!s&&{mode:s.mode}}},function(t,e){t.exports=function(t,e){if(e){if(1===e.length)return t[e[0]];if(2===e.length)return t[e[0]][e[1]];if(3===e.length)return t[e[0]][e[1]][e[2]];throw new Error("proxify property path is too deep, 3 layer nest limit: obj.a.b.c; obj: "+t+" path: "+e)}}},function(t,e,n){(function(e){var n=function(t){if(this.bitLength=null,this.byteLength=null,this.byteArray=null,"number"==typeof t)this.bitLength=t,this.byteLength=Math.ceil(t/8),this.byteArray=void 0!==e?new e(this.byteLength):new Uint8Array(this.byteLength);else if(t instanceof ArrayBuffer)this.bitLength=8*t.byteLength,this.byteLength=t.byteLength,this.byteArray=new Uint8Array(t);else{if(!(void 0!==e&&t instanceof e))throw new Error("Unable to create BitBuffer, expected length (in bits), ArrayBuffer, or Buffer");this.bitLength=8*t.length,this.byteLength=t.length,this.byteArray=new Uint8Array(t)}};n._scratch=new DataView(new ArrayBuffer(8)),n.concat=function(t){for(var r=0,i=0;i<t.length;i++)r+=t[i].bitLength;var o=new n(new e(Math.ceil(r/8))),s=0;for(i=0;i<t.length;i++)for(var a=0;a<t[i].bitLength;a++)o._setBit(t[i]._getBit(a),s),s++;return o},n.prototype.toBuffer=function(){return this.byteArray},n.prototype._getBit=function(t){return this.byteArray[t>>3]>>(7&t)&1},n.prototype._setBit=function(t,e){t?this.byteArray[e>>3]|=1<<(7&e):this.byteArray[e>>3]&=~(1<<(7&e))},n.prototype.getBits=function(t,e,n){var r=8*this.byteArray.length-t;if(e>r)throw new Error("Cannot get "+e+" bit(s) from offset "+t+", "+r+" available");for(var i=0,o=0;o<e;){var s=e-o,a=7&t,p=this.byteArray[t>>3],c=Math.min(s,8-a);i|=(p>>a&(1<<c)-1)<<o,t+=c,o+=c}return n?(32!==e&&i&1<<e-1&&(i|=-1^(1<<e)-1),i):i>>>0},n.prototype.setBits=function(t,e,n){var r=8*this.byteArray.length-e;if(n>r)throw new Error("Cannot set "+n+" bit(s) from offset "+e+", "+r+" available");for(var i=0;i<n;){var o;n-i>=8&&0==(7&e)?(this.byteArray[e>>3]=255&t,o=8):(this._setBit(1&t,e),o=1),t>>=o,e+=o,i+=o}},n.prototype.readBoolean=function(t){return 0!==this.getBits(t,1,!1)},n.prototype.readInt2=function(t){return this.getBits(t,2,!0)},n.prototype.readUInt2=function(t){return this.getBits(t,2,!1)},n.prototype.readInt3=function(t){return this.getBits(t,3,!0)},n.prototype.readUInt3=function(t){return this.getBits(t,3,!1)},n.prototype.readInt4=function(t){return this.getBits(t,4,!0)},n.prototype.readUInt4=function(t){return this.getBits(t,4,!1)},n.prototype.readInt5=function(t){return this.getBits(t,5,!0)},n.prototype.readUInt5=function(t){return this.getBits(t,5,!1)},n.prototype.readInt6=function(t){return this.getBits(t,6,!0)},n.prototype.readUInt6=function(t){return this.getBits(t,6,!1)},n.prototype.readInt7=function(t){return this.getBits(t,7,!0)},n.prototype.readUInt7=function(t){return this.getBits(t,7,!1)},n.prototype.readInt8=function(t){return this.getBits(t,8,!0)},n.prototype.readUInt8=function(t){return this.getBits(t,8,!1)},n.prototype.readInt9=function(t){return this.getBits(t,9,!0)},n.prototype.readUInt9=function(t){return this.getBits(t,9,!1)},n.prototype.readInt10=function(t){return this.getBits(t,10,!0)},n.prototype.readUInt10=function(t){return this.getBits(t,10,!1)},n.prototype.readInt11=function(t){return this.getBits(t,11,!0)},n.prototype.readUInt11=function(t){return this.getBits(t,11,!1)},n.prototype.readInt12=function(t){return this.getBits(t,12,!0)},n.prototype.readUInt12=function(t){return this.getBits(t,12,!1)},n.prototype.readInt16=function(t){return this.getBits(t,16,!0)},n.prototype.readUInt16=function(t){return this.getBits(t,16,!1)},n.prototype.readInt32=function(t){return this.getBits(t,32,!0)},n.prototype.readUInt32=function(t){return this.getBits(t,32,!1)},n.prototype.readFloat32=function(t){return n._scratch.setUint32(0,this.readUInt32(t)),n._scratch.getFloat32(0)},n.prototype.readFloat64=function(t){return n._scratch.setUint32(0,this.readUInt32(t)),n._scratch.setUint32(4,this.readUInt32(t+32)),n._scratch.getFloat64(0)},n.prototype.writeBoolean=function(t,e){this.setBits(t?1:0,e,1)},n.prototype.writeInt2=n.prototype.writeUInt2=function(t,e){this.setBits(t,e,2)},n.prototype.writeInt3=n.prototype.writeUInt3=function(t,e){this.setBits(t,e,3)},n.prototype.writeInt4=n.prototype.writeUInt4=function(t,e){this.setBits(t,e,4)},n.prototype.writeInt5=n.prototype.writeUInt5=function(t,e){this.setBits(t,e,5)},n.prototype.writeInt6=n.prototype.writeUInt6=function(t,e){this.setBits(t,e,6)},n.prototype.writeInt7=n.prototype.writeUInt7=function(t,e){this.setBits(t,e,7)},n.prototype.writeInt8=n.prototype.writeUInt8=function(t,e){this.setBits(t,e,8)},n.prototype.writeInt9=n.prototype.writeUInt9=function(t,e){this.setBits(t,e,9)},n.prototype.writeInt10=n.prototype.writeUInt10=function(t,e){this.setBits(t,e,10)},n.prototype.writeInt11=n.prototype.writeUInt11=function(t,e){this.setBits(t,e,11)},n.prototype.writeInt12=n.prototype.writeUInt12=function(t,e){this.setBits(t,e,12)},n.prototype.writeInt16=n.prototype.writeUInt16=function(t,e){this.setBits(t,e,16)},n.prototype.writeInt32=n.prototype.writeUInt32=function(t,e){this.setBits(t,e,32)},n.prototype.writeFloat32=function(t,e){n._scratch.setFloat32(0,t),this.setBits(n._scratch.getUint32(0),e,32)},n.prototype.writeFloat64=function(t,e){n._scratch.setFloat64(0,t),this.setBits(n._scratch.getUint32(0),e,32),this.setBits(n._scratch.getUint32(4),e+32,32)},t.exports=n}).call(e,n(60).Buffer)},function(t,e){function n(t,e){this.bitBuffer=t,this.offset=void 0===e?0:e}var r=function(t,e){return function(){var n=this.bitBuffer[t](this.offset);return this.offset+=e,n}},i=function(t,e){return function(n){this.bitBuffer[t](n,this.offset),this.offset+=e}};n.prototype.writeBoolean=i("writeBoolean",1),n.prototype.writeInt2=i("writeInt2",2),n.prototype.writeUInt2=i("writeUInt2",2),n.prototype.writeInt3=i("writeInt3",3),n.prototype.writeUInt3=i("writeUInt3",3),n.prototype.writeInt4=i("writeInt4",4),n.prototype.writeUInt4=i("writeUInt4",4),n.prototype.writeInt5=i("writeInt5",5),n.prototype.writeUInt5=i("writeUInt5",5),n.prototype.writeInt6=i("writeInt6",6),n.prototype.writeUInt6=i("writeUInt6",6),n.prototype.writeInt7=i("writeInt7",7),n.prototype.writeUInt7=i("writeUInt7",7),n.prototype.writeInt8=i("writeInt8",8),n.prototype.writeUInt8=i("writeUInt8",8),n.prototype.writeInt9=i("writeInt9",9),n.prototype.writeUInt9=i("writeUInt9",9),n.prototype.writeInt10=i("writeInt10",10),n.prototype.writeUInt10=i("writeUInt10",10),n.prototype.writeInt11=i("writeInt11",11),n.prototype.writeUInt11=i("writeUInt11",11),n.prototype.writeInt12=i("writeInt12",12),n.prototype.writeUInt12=i("writeUInt12",12),n.prototype.writeInt16=i("writeInt16",16),n.prototype.writeUInt16=i("writeUInt16",16),n.prototype.writeInt32=i("writeInt32",32),n.prototype.writeUInt32=i("writeUInt32",32),n.prototype.writeFloat32=i("writeFloat32",32),n.prototype.writeFloat64=i("writeFloat64",64),n.prototype.readBoolean=r("readBoolean",1),n.prototype.readInt2=r("readInt2",2),n.prototype.readUInt2=r("readUInt2",2),n.prototype.readInt3=r("readInt3",3),n.prototype.readUInt3=r("readUInt3",3),n.prototype.readInt4=r("readInt4",4),n.prototype.readUInt4=r("readUInt4",4),n.prototype.readInt5=r("readInt5",5),n.prototype.readUInt5=r("readUInt5",5),n.prototype.readInt6=r("readInt6",6),n.prototype.readUInt6=r("readUInt6",6),n.prototype.readInt7=r("readInt7",7),n.prototype.readUInt7=r("readUInt7",7),n.prototype.readInt8=r("readInt8",8),n.prototype.readUInt8=r("readUInt8",8),n.prototype.readInt9=r("readInt9",9),n.prototype.readUInt9=r("readUInt9",9),n.prototype.readInt10=r("readInt10",10),n.prototype.readUInt10=r("readUInt10",10),n.prototype.readInt11=r("readInt11",11),n.prototype.readUInt11=r("readUInt11",11),n.prototype.readInt12=r("readInt12",12),n.prototype.readUInt12=r("readUInt12",12),n.prototype.readInt16=r("readInt16",16),n.prototype.readUInt16=r("readUInt16",16),n.prototype.readInt32=r("readInt32",32),n.prototype.readUInt32=r("readUInt32",32),n.prototype.readFloat32=r("readFloat32",32),n.prototype.readFloat64=r("readFloat64",64),t.exports=n},function(t,e,n){var r=n(0),i=n(18),o=n(10),s=function(t,e,n,a,p){var c=0,h={};n&&(c=n,h[p]=a);for(var u=c;u<e.keys.length;u++){var l=e.keys[u],f=e.properties[l];if(f.protocol&&f.isArray){for(var d=t[r[f.arrayIndexType].read](),y=[],g=0;g<d;g++)y.push(s(t,f.protocol));m=y}else if(f.protocol)var m=s(t,f.protocol);else m=i(t,f.type,f.arrayIndexType);o(h,f.path,m)}return h};t.exports=s},function(t,e){t.exports=function(t,e,n){1===e.length?t[e[0]]=n:2===e.length?(void 0===t[e[0]]&&(t[e[0]]={}),t[e[0]][e[1]]=n):3===e.length&&(void 0===t[e[0]]&&(t[e[0]]={}),void 0===t[e[0]][e[1]]&&(t[e[0]][e[1]]={}),t[e[0]][e[1]][e[2]]=n)}},function(t,e){t.exports=function(t,e){return{a:t,b:e,isChanged:t!==e}}},function(t,e,n){var r={min:0,max:255,bits:8,compare:n(2),write:"writeUInt8",read:"readUInt8",boundsCheck:function(t){return t>=r.min&&t<=r.max}};t.exports=r},function(t,e,n){!function(t){var e,n,r,i=String.fromCharCode;function o(t){for(var e,n,r=[],i=0,o=t.length;i<o;)(e=t.charCodeAt(i++))>=55296&&e<=56319&&i<o?56320==(64512&(n=t.charCodeAt(i++)))?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),i--):r.push(e);return r}function s(t){if(t>=55296&&t<=57343)throw Error("Lone surrogate U+"+t.toString(16).toUpperCase()+" is not a scalar value")}function a(t,e){return i(t>>e&63|128)}function p(t){if(0==(4294967168&t))return i(t);var e="";return 0==(4294965248&t)?e=i(t>>6&31|192):0==(4294901760&t)?(s(t),e=i(t>>12&15|224),e+=a(t,6)):0==(4292870144&t)&&(e=i(t>>18&7|240),e+=a(t,12),e+=a(t,6)),e+=i(63&t|128)}function c(){if(r>=n)throw Error("Invalid byte index");var t=255&e[r];if(r++,128==(192&t))return 63&t;throw Error("Invalid continuation byte")}function h(){var t,i;if(r>n)throw Error("Invalid byte index");if(r==n)return!1;if(t=255&e[r],r++,0==(128&t))return t;if(192==(224&t)){if((i=(31&t)<<6|c())>=128)return i;throw Error("Invalid continuation byte")}if(224==(240&t)){if((i=(15&t)<<12|c()<<6|c())>=2048)return s(i),i;throw Error("Invalid continuation byte")}if(240==(248&t)&&(i=(7&t)<<18|c()<<12|c()<<6|c())>=65536&&i<=1114111)return i;throw Error("Invalid UTF-8 detected")}t.version="3.0.0",t.encode=function(t){for(var e=o(t),n=e.length,r=-1,i="";++r<n;)i+=p(e[r]);return i},t.decode=function(t){e=o(t),n=e.length,r=0;for(var s,a=[];!1!==(s=h());)a.push(s);return function(t){for(var e,n=t.length,r=-1,o="";++r<n;)(e=t[r])>65535&&(o+=i((e-=65536)>>>10&1023|55296),e=56320|1023&e),o+=i(e);return o}(a)}}(e)},function(t,e,n){var r=n(5);t.exports=function(t,e,n){t[e.TYPE_PROPERTY_NAME]={type:e.TYPE_BINARY_TYPE,interp:!1,isArray:!1},t[e.ID_PROPERTY_NAME]={type:e.ID_BINARY_TYPE,interp:!1,isArray:!1};var i=new r(t,e,null,n,!0);return i.type="Entity",i}},function(t,e,n){var r=n(5);t.exports=function(t,e){if(t[e.TYPE_PROPERTY_NAME]={type:e.TYPE_BINARY_TYPE,interp:!1,isArray:!1},void 0===t.x)throw new Error("EventSchema must define x.");if(void 0===t.y)throw new Error("EventSchema must define y.");var n=new r(t,e);return n.type="LocalEvent",n}},function(t,e,n){var r=n(5);t.exports=function(t,e){t[e.TYPE_PROPERTY_NAME]={type:e.TYPE_BINARY_TYPE,interp:!1,isArray:!1};var n=new r(t,e);return n.type="Message",n}},function(t,e,n){var r=n(5);t.exports=function(t,e){t[e.TYPE_PROPERTY_NAME]={type:e.TYPE_BINARY_TYPE,interp:!1,isArray:!1};var n=new r(t,e);return n.type="Command",n}},function(t,e,n){var r=n(0);t.exports=function(t,e,n){var i=r[e];if("number"==typeof n){for(var o=t[r[n].read](),s=[],a=0;a<o;a++)if(i.customRead){var p=i.read(t);s.push(p)}else p=t[i.read](),s.push(p);return s}return i.customRead?i.read(t):t[i.read]()}},function(t,e,n){var r=n(20),i=n(10),o=n(6);function s(){this.state={}}s.prototype.saveEntity=function(t,e){var n=r(t,e);n.protocol=t.protocol,this.state[t.id]=n},s.prototype.deleteEntity=function(t){delete this.state[t]},s.prototype.updateEntityPartial=function(t,e,n){i(this.state[t],e,n)},s.prototype.updateEntityOptimized=function(t,e,n){var r=o(this.state[t],e);i(this.state[t],e,r+n)},s.prototype.getEntity=function(t){return this.state[t]},s.prototype.saveSnapshot=function(t,e){for(var n=0;n<t.createEntities.length;n++){var r=t.createEntities[n];this.saveEntity(r,r.protocol)}for(n=0;n<t.updateEntities.partial.length;n++){var i=t.updateEntities.partial[n];this.updateEntityPartial(i.id,i.path,i.value)}for(n=0;n<t.updateEntities.optimized.length;n++){var o=t.updateEntities.optimized[n];o.updates.forEach(t=>{t.isDelta?this.updateEntityOptimized(o.id,t.path,t.value):this.updateEntityPartial(o.id,t.path,t.value)})}for(n=0;n<t.deleteEntities.length;n++){var s=t.deleteEntities[n];this.deleteEntity(s)}for(n=0;n<t.createComponents.length;n++){r=t.createComponents[n];this.saveEntity(r,r.protocol)}for(n=0;n<t.updateComponents.partial.length;n++){i=t.updateComponents.partial[n];this.updateEntityPartial(i.id,i.path,i.value)}for(n=0;n<t.deleteComponents.length;n++){s=t.deleteComponents[n];this.deleteEntity(s)}},t.exports=s},function(t,e,n){var r=n(91);t.exports=function(t,e){return r(t,e)}},function(t,e,n){const r=n(3);class i{constructor(t,e){this.x=t,this.y=e,this.id=-1,this.active=1,this.visible=1,this.isDestroy=0,this.anim=4,this.kill=0}}i.protocol={x:r.Float32,y:r.Float32,id:r.UInt16,active:r.Boolean,visible:r.Boolean,isDestroy:r.Boolean,anim:r.UInt16,kill:r.UInt16},t.exports=i},function(t,e,n){const r=n(3);class i{constructor(t,e,n,r){this.x=t,this.y=e,this.anim=n,this.kill=r}}i.protocol={x:r.Float32,y:r.Float32,anim:r.UInt16,kill:r.UInt16},t.exports=i},function(t,e,n){const r=n(3);class i{constructor(t,e){this.id=t,this.killedId=e}}i.protocol={id:r.UInt16,killedId:r.UInt16},t.exports=i},function(t,e,n){const r=n(25),i=n(105);var o,s,a,p=0,c=new Phaser.Class({Extends:Phaser.Scene,initialize:function(){Phaser.Scene.call(this,{key:"sceneMain"})},preload:function(){this.load.image("circle","assets/circle.png"),this.load.image("body","assets/body.png"),this.load.image("sword","assets/sword.png"),this.load.image("hole","assets/hole.png"),this.load.spritesheet("walkLeft","assets/walkLeft.png",{frameWidth:32,frameHeight:32}),this.load.spritesheet("walkRight","assets/walkRight.png",{frameWidth:32,frameHeight:32}),this.load.spritesheet("walkDown","assets/walkDown.png",{frameWidth:32,frameHeight:32}),this.load.spritesheet("walkUp","assets/walkUp.png",{frameWidth:32,frameHeight:32})},create:function(){this.cameras.main.setBounds(0,0,1600,1200),this.physics.world.setBounds(0,0,1600,1200),this.anims.create({key:"walkDown",frames:this.anims.generateFrameNumbers("walkDown",{start:0,end:2}),frameRate:5,repeat:-1}),this.anims.create({key:"walkRight",frames:this.anims.generateFrameNumbers("walkRight",{start:0,end:2}),frameRate:5,repeat:-1}),this.anims.create({key:"walkUp",frames:this.anims.generateFrameNumbers("walkUp",{start:0,end:2}),frameRate:5,repeat:-1}),this.anims.create({key:"walkLeft",frames:this.anims.generateFrameNumbers("walkLeft",{start:0,end:2}),frameRate:5,repeat:-1});var t={x:(s=new i(this)).player.x,y:s.player.y,cameraWidth:800,cameraHeigth:600};void 0==a&&(a=new r(s,t),s.gameClient=a),o=this.input.keyboard.createCursorKeys(),this.score=0,this.scoreText=this.add.text(16,16,"score: 0").setScrollFactor(0)},update:function(t,e){if(null!==s.player&&void 0!==s.player){var n,r=s.player.getByName("body"),i=s.player.getByName("hole"),c=s.player.getByName("sword"),h=s.player.getData("kill");n=2+.2*h<=10?2+.2*h:10,i.scale=n,s.player.body.setVelocity(0),o.left.isDown?(s.player.body.setVelocityX(-150),r.anims.play("walkLeft",!0),this.tweens.add({targets:[c],angle:180,ease:"Sine.In",duration:e,repeat:0}),i.x=-(64+32*n),i.y=0):o.right.isDown&&(s.player.body.setVelocityX(150),r.anims.play("walkRight",!0),this.tweens.add({targets:[c],angle:0,ease:"Sine.In",duration:e,repeat:0}),i.x=64+32*n,i.y=0),o.up.isDown?(s.player.body.setVelocityY(-150),r.anims.play("walkUp",!0),this.tweens.add({targets:[c],angle:270,ease:"Sine.In",duration:e,repeat:0}),i.x=0,i.y=-(64+32*n)):o.down.isDown&&(s.player.body.setVelocityY(150),r.anims.play("walkDown",!0),this.tweens.add({targets:[c],angle:90,ease:"Sine.In",duration:e,repeat:0}),i.x=0,i.y=64+32*n),++p%1==0&&(s.destroyPlayer(),a.update(e))}s.players.getAll().forEach(t=>{let e=t.getByName("body");0===e.getData("anim")?e.anims.play("walkUp",!0):1===e.getData("anim")?e.anims.play("walkRight",!0):2===e.getData("anim")?e.anims.play("walkDown",!0):3===e.getData("anim")&&e.anims.play("walkLeft",!0)})}}),h=n(106),u={type:Phaser.AUTO,backgroundColor:"#202826",physics:{default:"arcade",arcade:{}},scene:[h,c]};new Phaser.Game(u)},function(t,e,n){const r=n(3),i=n(97),o=n(104),s=100;t.exports=class{constructor(t,e){this.clientProcessor=new o(this,t),this.client=new r.Client(i,s),this.client.onConnect(t=>{console.log("onConnect response:",t)}),this.client.onTransfer(t=>{console.log("client transfer",t)}),this.client.onClose(()=>{console.log("connection  closed")}),this.client.connect("ws://localhost:8079",e)}update(t,e,n){let r=this.client.readNetwork();r.entities.forEach(e=>{e.createEntities.forEach(t=>{this.clientProcessor.createEntity(t)}),e.updateEntities.forEach(e=>{this.clientProcessor.updateEntities(e,t)}),e.deleteEntities.forEach(t=>{this.clientProcessor.deleteEntities(t)})}),r.messages.forEach(t=>{this.clientProcessor.processMessage(t)}),r.localMessages.forEach(t=>{this.clientProcessor.processLocalMessage(t)}),this.clientProcessor.processUpdate(t)}}},function(t,e){t.exports=function(t,e,n){var r=null,i=!1,o=!1,s=null,a=null;if("object"==typeof e){if(void 0!==e.metaType&&"protocol"===e.metaType&&(a=e,n))throw new Error("this protocol type does not support nested protocols; index: "+t+"  propConfig: "+e);if(r=e.type,void 0!==e.interp&&(i=e.interp),void 0!==e.indexType&&(void 0!==e.type.prototype?(r=e.type.prototype.protocol,a=e.type.prototype.protocol):r=e.type,o=!0,s=e.indexType,n))throw new Error("this protocol type does not support arrays; index: "+t+"  propConfig: "+e)}else r=e;return{key:t,protocol:a,type:r,interp:i,isArray:o,arrayIndexType:s}}},function(t,e){t.exports=function(t,e){var n=-1,r=!1;if("object"!=typeof e)throw new Error("unknown schema optimization syntax; index: "+t+" optConfig: "+e);return n=e.type,void 0!==e.delta&&(r=e.delta),{key:t,type:n,delta:r}}},function(t,e,n){var r=n(1),i=n(0),o=[r.UInt2,r.UInt3,r.UInt4,r.UInt5,r.UInt6,r.UInt7,r.UInt8,r.UInt9,r.UInt10,r.UInt11,r.UInt12,r.UInt16,r.UInt32];t.exports=function(t){for(var e=0;e<o.length;e++){var n=o[e];if(i[n].max>=t)return n}throw new Error("selectUIntType max out of bounds")}},function(t,e){var n={bits:1,write:"writeBoolean",read:"readBoolean",boundsCheck:function(t){return"boolean"==typeof t},compare:function(t,e){return{a:t,b:e,isChanged:t!==e}}};t.exports=n},function(t,e,n){var r={min:0,max:3,bits:2,compare:n(2),write:"writeUInt2",read:"readUInt2",boundsCheck:function(t){return t>=r.min&&t<=r.max}};t.exports=r},function(t,e,n){var r={min:0,max:7,bits:3,compare:n(2),write:"writeUInt3",read:"readUInt3",boundsCheck:function(t){return t>=r.min&&t<=r.max}};t.exports=r},function(t,e,n){var r={min:0,max:15,bits:4,compare:n(2),write:"writeUInt4",read:"readUInt4",boundsCheck:function(t){return t>=r.min&&t<=r.max}};t.exports=r},function(t,e,n){var r={min:0,max:31,bits:5,compare:n(2),write:"writeUInt5",read:"readUInt5",boundsCheck:function(t){return t>=r.min&&t<=r.max}};t.exports=r},function(t,e,n){var r={min:0,max:63,bits:6,compare:n(2),write:"writeUInt6",read:"readUInt6",boundsCheck:function(t){return t>=r.min&&t<=r.max}};t.exports=r},function(t,e,n){var r={min:0,max:127,bits:7,compare:n(2),write:"writeUInt7",read:"readUInt7",boundsCheck:function(t){return t>=r.min&&t<=r.max}};t.exports=r},function(t,e,n){var r={min:0,max:511,bits:9,compare:n(2),write:"writeUInt9",read:"readUInt9",boundsCheck:function(t){return t>=r.min&&t<=r.max}};t.exports=r},function(t,e,n){var r={min:0,max:1023,bits:10,compare:n(2),write:"writeUInt10",read:"readUInt10",boundsCheck:function(t){return t>=r.min&&t<=r.max}};t.exports=r},function(t,e,n){var r={min:0,max:2047,bits:11,compare:n(2),write:"writeUInt11",read:"readUInt11",boundsCheck:function(t){return t>=r.min&&t<=r.max}};t.exports=r},function(t,e,n){var r={min:0,max:4095,bits:12,compare:n(2),write:"writeUInt12",read:"readUInt12",boundsCheck:function(t){return t>=r.min&&t<=r.max}};t.exports=r},function(t,e,n){var r={min:0,max:65535,bits:16,compare:n(2),write:"writeUInt16",read:"readUInt16",boundsCheck:function(t){return t>=r.min&&t<=r.max}};t.exports=r},function(t,e,n){var r={min:0,max:4294967295,bits:32,compare:n(2),write:"writeUInt32",read:"readUInt32",boundsCheck:function(t){return t>=r.min&&t<=r.max}};t.exports=r},function(t,e,n){var r={min:-8,max:7,bits:4,compare:n(2),write:"writeInt4",read:"readInt4",boundsCheck:function(t){return t>=r.min&&t<=r.max}};t.exports=r},function(t,e,n){var r={min:-32,max:31,bits:6,compare:n(2),write:"writeInt6",read:"readInt6",boundsCheck:function(t){return t>=r.min&&t<=r.max}};t.exports=r},function(t,e,n){var r={min:-128,max:127,bits:8,compare:n(2),write:"writeInt8",read:"readInt8",boundsCheck:function(t){return t>=r.min&&t<=r.max}};t.exports=r},function(t,e,n){var r={min:-512,max:511,bits:10,compare:n(2),write:"writeInt10",read:"readInt10",boundsCheck:function(t){return t>=r.min&&t<=r.max}};t.exports=r},function(t,e,n){var r={min:-32768,max:32767,bits:16,compare:n(2),write:"writeInt16",read:"readInt16",boundsCheck:function(t){return t>=r.min&&t<=r.max}};t.exports=r},function(t,e,n){var r={min:-2147483648,max:2147483647,bits:32,compare:n(2),write:"writeInt32",read:"readInt32",boundsCheck:function(t){return t>=r.min&&t<=r.max}};t.exports=r},function(t,e,n){var r={bits:32,compare:n(11),write:"writeFloat32",read:"readFloat32",boundsCheck:function(t){return!0}};t.exports=r},function(t,e,n){var r={bits:64,compare:n(11),write:"writeFloat64",read:"readFloat64",boundsCheck:function(t){return!0}};t.exports=r},function(t,e){var n={min:0,max:255,boundsCheck:r,bits:8,write:"writeUInt8",read:"readUInt8"},r=function(t){return t>=n.min&&t<=n.max};t.exports=n},function(t,e){var n=function(t){return Math.floor(function(t,e,n,r,i){return(i-r)*(t-e)/(n-e)+r}(t,0,2*Math.PI,0,255)%256)},r=function(t){return t*(2*Math.PI/255)},i={min:0,max:255,interp:function(t,e,n){throw new Error("nengi.Rotation8 interpolation is not implemented. Try nengi.RotationFloat32 instead.")},boundsCheck:function(t){return t>=i.min&&t<=i.max},compare:function(t,e){var r=n(t),i=n(e);return{a:r,b:i,isChanged:r!==i}},bits:8,customWrite:!0,write:function(t,e){t.writeUInt8(e)},customRead:!0,read:function(t){var e=t.readUInt8();return r(e)}};t.exports=i},function(t,e,n){const r={min:0,max:255,interp:function(t,e,n){let r=(1-n)*Math.sin(t)+n*Math.sin(e),i=(1-n)*Math.cos(t)+n*Math.cos(e);return Math.atan2(r,i)},compare:n(11),bits:32,customWrite:!0,write:function(t,e){t.writeFloat32(e)},customRead:!0,read:function(t){return t.readFloat32()}};t.exports=r},function(t,e,n){var r=n(12),i={customCompare:!0,compare:function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},boundsCheck:function(t){return t[0]>=r.min&&t[0]<=r.max&&t[1]>=r.min&&t[1]<=r.max&&t[2]>=r.min&&t[2]<=r.max},bits:24,customWrite:!0,write:function(t,e){t.writeUInt8(e[0]),t.writeUInt8(e[1]),t.writeUInt8(e[2])},customRead:!0,read:function(t){return[bitBuffer.readUInt8(),bitBuffer.readUInt8(),bitBuffer.readUInt8()]}};t.exports=i},function(t,e){var n=function(t){var e=[];if(!(t.length<256))throw new Error("ASCIIString exceeded 255 character limit: "+t);e.push(t.length);for(var n=0;n<t.length;n++)e.push(t.charCodeAt(n));return e},r={boundsCheck:function(t){return t.length<256},customBits:!0,countBits:function(t){var e=8;return e+=8*t.length},customWrite:!0,write:function(t,e){for(var r=n(e),i=0;i<r.length;i++)t.writeUInt8(r[i])},customRead:!0,read:function(t){for(var e=t.readUInt8(),n="",r=0;r<e;r++)n+=String.fromCharCode(t.readUInt8());return n},compare:function(t,e){return{a:t,b:e,isChanged:t!==e}}};t.exports=r},function(t,e,n){var r=n(13),i={boundsCheck:function(t){return t.length<=4294967295},customBits:!0,countBits:function(t){var e=32;return e+=8*r.encode(t).length},customWrite:!0,write:function(t,e){var n=r.encode(e);t.writeUInt32(n.length);for(var i=0;i<n.length;i++)t.writeUInt8(n.charCodeAt(i))},customRead:!0,read:function(t){for(var e=t.readUInt32(),n="",i=0;i<e;i++)n+=String.fromCharCode(t.readUInt8());return r.decode(n)},compare:function(t,e){return{a:t,b:e,isChanged:t!==e}}};t.exports=i},function(t,e,n){var r=n(57),i=n(59),o=n(80),s=n(87),a=n(90),p=n(19),c=n(0),h=n(6),u=n(92);const l=n(94);function f(t,e){this.config=t,this.interpDelay=e,this.protocols=new r(t,l),this.unconfirmedCommands=new Map,this.tickLength=1e3/t.UPDATE_RATE,this.entityCache=new p,this.interpCache=new p,this.websocket=null,this.snapshots=[],this.latest=null,this.serverTick=0,this.updateTick=0,this.lastProcessedTick=-1,this.onStringData=null,this.sendQueue={},this.lastSentTick=0,this.averagePing=100,this.pings=[],this.avgDiff=0,this.avgDiffs=[],this.connectionCallback=null,this.closeCallback=null,this.transferCallback=null,this.messages=[],this.localMessages=[],this.jsons=[]}f.prototype.reset=function(){this.websocket.close(),this.entityCache=new p,this.cache=new p,this.snapshots=[],this.serverTick=0,this.updateTick=0,this.lastProcessedTick=-1,this.sendQueue={},this.lastSentTick=0,this.averagePing=100,this.pings=[],this.avgDiff=0,this.avgDiffs=[]},f.prototype.readNetwork=function(){let t=this.interpolate(this.interpDelay);return t.latest=this.latest,t.messages=this.messages.splice(0,this.messages.length),t.localMessages=this.localMessages.splice(0,this.localMessages.length),t.jsons=this.jsons.splice(0,this.jsons.length),t},f.prototype.onClose=function(t){this.closeCallback=t},f.prototype.onTransfer=function(t){this.transferCallback=((e,n)=>{var r={transferKey:e};t(r),this.reset(),this.connect(n,r)})},f.prototype.onConnect=function(t){this.connectionCallback=t},f.prototype.update=function(){for(var t=this.lastSentTick;t<this.updateTick;t++)this.sendCommands(t),this.lastSentTick=t;this.updateTick++},f.prototype.getUnconfirmedCommands=function(){return this.unconfirmedCommands},f.prototype.addCommand=function(t){var e=this.updateTick;void 0===this.sendQueue[e]&&(this.sendQueue[e]=[]),this.unconfirmedCommands.has(e)||this.unconfirmedCommands.set(e,[]),t.type=this.protocols.getIndex(t.protocol),this.sendQueue[e].push(t),this.unconfirmedCommands.get(e).push(t)},f.prototype.sendCommands=function(t){if(this.websocket&&1===this.websocket.readyState){var e=this.sendQueue[t];e||(e=[]),this.websocket.send(o(t,e).byteArray),delete this.sendQueue[t]}},f.prototype.findInitialSnapshot=function(t){for(var e=this.snapshots.length-1;e>=0;e--){var n=this.snapshots[e];if(n.timestamp<t)return{snapshot:n,index:e}}};function d(t,e,n){return t*(1-n)+e*n}f.prototype.interpolate=function(t){var e=Date.now()-t-this.avgDiff;e;var n=[],r=null,i=null,o=this.findInitialSnapshot(e);if(o&&(i=o.snapshot,o.index),i){for(var s=i.tick,a=0;a<this.snapshots.length;a++){var p=this.snapshots[a];p.tick===s+1&&(r=p)}var u={createEntities:[],deleteEntities:[],updateEntities:[],localMessages:[],messages:[],jsons:[],tick:null};if(i.tick-1>this.lastProcessedTick)for(a=this.snapshots.length-1;a>-1;a--){(f=this.snapshots[a]).tick<i.tick&&!f.processed&&(n.push(f),f.processed=!0,this.snapshots.splice(a,1))}n.reverse();for(var l=0;l<n.length;l++){var f=n[l];for(a=0;a<f.createEntities.length;a++)this.interpCache.saveEntity(f.createEntities[a],f.createEntities[a].protocol);for(a=0;a<f.updateEntities.length;a++)this.interpCache.updateEntityPartial(f.updateEntities[a].id,f.updateEntities[a].path,f.updateEntities[a].value);for(a=0;a<f.deleteEntities.length;a++)this.interpCache.deleteEntity(f.deleteEntities[a])}if(!i.processed){u.timestamp=i.timestamp,u.createEntities=u.createEntities.concat(i.createEntities),u.deleteEntities=u.deleteEntities.concat(i.deleteEntities),u.updateEntities=u.updateEntities.concat(i.updateEntities),i.processed=!0,u.tick=i.tick,this.lastProcessedTick=i.tick;for(a=0;a<u.createEntities.length;a++)this.interpCache.saveEntity(u.createEntities[a],u.createEntities[a].protocol);for(a=0;a<u.updateEntities.length;a++)this.interpCache.updateEntityPartial(u.updateEntities[a].id,u.updateEntities[a].path,u.updateEntities[a].value);for(a=0;a<u.deleteEntities.length;a++)this.interpCache.deleteEntity(u.deleteEntities[a])}}if(r&&i&&i.tick>=this.lastProcessedTick){var y=this.tickLength,g=(e-i.timestamp)/y;g>1&&(g=1),u.timestamp=d(i.timestamp,r.timestamp,g);for(a=0;a<i.updateEntities.length;a++){var m=i.updateEntities[a],v=i.entities.get(m.id),I=m.prop,w=v.protocol.properties[I],E=c[w.type];if(w.interp){var b=r.entities.get(m.id),U=h(v,w.path),x=U;if(b){var P=h(b,w.path);x="function"==typeof E.interp?E.interp(U,P,g):d(U,P,g)}x!==h(this.interpCache.getEntity(m.id),w.path)&&u.updateEntities.push({id:m.id,prop:I,path:w.path,value:x})}else m.value!==h(this.interpCache.getEntity(m.id),m.path)&&u.updateEntities.push(m)}}if(u){for(a=0;a<u.updateEntities.length;a++)this.interpCache.updateEntityPartial(u.updateEntities[a].id,u.updateEntities[a].path,u.updateEntities[a].value);n.push(u)}return{entities:n,interpA:i,interpB:r}},f.prototype.getSnapshots=function(){return this.snapshots},f.prototype.connect=function(t,e){this.websocket=new WebSocket(t,"nengi-protocol"),this.websocket.binaryType="arraybuffer",void 0!==e&&e||(e={}),this.websocket.onopen=(t=>{this.websocket.send(a(e).byteArray)}),this.websocket.onerror=(t=>{console.log("WebSocket error",t)}),this.websocket.onclose=(()=>{this.closeCallback&&this.closeCallback()}),this.websocket.onmessage=(t=>{if(t.data instanceof ArrayBuffer){var e=i(t.data,this.protocols,this.entityCache,this.config,this.connectionCallback,this.transferCallback);if(!e)return;if(this.messages=this.messages.concat(e.messages),this.localMessages=this.localMessages.concat(e.localMessages),this.jsons=this.jsons.concat(e.jsons),-1!==e.pingKey){var n=s(e.pingKey);this.websocket.send(n.byteArray)}-1!==e.avgLatency&&(this.averagePing=e.avgLatency);var r=new u(this.serverTick,this.tickLength,e,this.latest);this.avgDiffs.push(Date.now()-r.timestamp);for(var o=0,a=0;a<this.avgDiffs.length;a++)o+=this.avgDiffs[a];for(this.avgDiff=o/this.avgDiffs.length;this.avgDiffs.length>20;)this.avgDiffs.shift();this.latest=r,this.unconfirmedCommands.forEach((t,e)=>{e<=this.latest.clientTick&&this.unconfirmedCommands.delete(e)}),this.snapshots.push(r),this.serverTick++,this.snapshots[this.snapshots.length-20]&&this.snapshots[this.snapshots.length-20].processed&&this.snapshots.splice(this.snapshots.length-20,1)}else"string"==typeof t.data?"function"==typeof this.onStringData&&this.onStringData(t.data):console.log("unknown websocket data type")})},t.exports=f},function(t,e,n){var r=n(5),i=n(14),o=n(16),s=n(15),a=n(17),p=n(58);function c(t,e){this.lookupByIndex=new Map,this.lookupByProtocol=new Map,this.protocolIndex=0,this.lookupMetaByIndex=new Map,this.lookupMetaByProtocol=new Map,this.processMeta(t,e,"messages"),this.processProtocols(t,"basics",r),this.processProtocols(t,"entities",i),this.processProtocols(t,"components",i),this.processProtocols(t,"messages",o),this.processProtocols(t,"localMessages",s),this.processProtocols(t,"commands",a)}c.prototype.processMeta=function(t,e,n){for(var r=0;r<e[n].length;r++){var i=e[n][r][0],s=e[n][r][1],a=e[n][r][2],p=new o(s,t);this.lookupMetaByIndex.set(a,p),this.lookupMetaByProtocol.set(p,a),p.name=i}},c.prototype.processProtocols=function(t,e,n){let r=t.protocols[e];if(r)for(var o=0;o<r.length;o++){let l=r[o];if(Array.isArray(l)){var s=l[0],a=l[1];if(2===l.length){var c=new n(h=a.protocol,t);this.lookupByIndex.set(this.protocolIndex,c),this.lookupByProtocol.set(c,this.protocolIndex),a.prototype.protocol=c,c.name=s,this.protocolIndex++}else{var h=l[2],u=l[3];c=new n(h,t);this.lookupByIndex.set(u,c),this.lookupByProtocol.set(c,u),c.name=s}}else{if("components"===e){let e=new p(l.protocol,t,l.components);this.lookupByIndex.set(l.type,e),this.lookupByProtocol.set(e,l.type),e.name=l.name}if("entities"===e){let e=new i(l.protocol,t,l.components);this.lookupByIndex.set(l.type,e),this.lookupByProtocol.set(e,l.type),e.name=l.name}}}},c.prototype.getMetaProtocol=function(t){return this.lookupMetaByIndex.get(t)},c.prototype.getMetaIndex=function(t){return this.lookupMetaByProtocol.get(t)},c.prototype.getProtocol=function(t){return this.lookupByIndex.get(t)},c.prototype.getIndex=function(t){return this.lookupByProtocol.get(t)},t.exports=c},function(t,e,n){var r=n(5);t.exports=function(t,e,n){t[e.TYPE_PROPERTY_NAME]={type:e.TYPE_BINARY_TYPE,interp:!1,isArray:!1},t[e.ID_PROPERTY_NAME]={type:e.ID_BINARY_TYPE,interp:!1,isArray:!1},t[e.PARENT_ID_PROPERTY_NAME]={type:e.ID_BINARY_TYPE,interp:!1,isArray:!1};var i=new r(t,e,null,n,!0);return i.type="Component",i}},function(t,e,n){n(0);var r=n(7),i=n(8),o=n(65),s=n(67),a=(n(69),n(70)),p=(n(71),n(72)),c=n(73),h=n(75),u=n(76),l=n(77),f=n(78),d=n(79),y=n(4).Chunk;n(4).ChunkReverse;t.exports=function(t,e,n,g,m,v){for(var I=new r(t),w=new i(I),E={tick:0,clientTick:-1,timestamp:-1,pingKey:-1,avgLatency:-1,engineMessages:[],localMessages:[],messages:[],jsons:[],createEntities:[],deleteEntities:[],updateEntities:{full:[],partial:[],optimized:[]},createComponents:[],deleteComponents:[],updateComponents:{full:[],partial:[],optimized:[]}};w.offset+16<=I.bitLength;)switch(w.readUInt8()){case y.Engine:var b=d(w,e,g);E.engineMessages=b;break;case y.ClientTick:E.clientTick=w.readUInt32();break;case y.Ping:var U=u(w);E.pingKey=U;break;case y.Timesync:var x=h(w);E.timestamp=x.time,E.avgLatency=x.avgLatency;break;case y.CreateEntities:var P=p(w,e,g);E.createEntities=P;break;case y.UpdateEntitiesPartial:var k=s(w,n,g);E.updateEntities.partial=k;break;case y.UpdateEntitiesOptimized:var C=o(w,n);E.updateEntities.optimized=C;break;case y.DeleteEntities:var B=a(w,g);E.deleteEntities=B;break;case y.CreateComponents:P=p(w,e,g),E.createComponents=P;break;case y.UpdateComponentsPartial:k=s(w,n,g),E.updateComponents.partial=k;break;case y.DeleteComponents:B=a(w,g),E.deleteComponents=B;break;case y.LocalEvents:var T=p(w,e,g);E.localMessages=T;break;case y.Messages:var A=p(w,e,g);E.messages=A;break;case y.JSONs:var R=c(w);E.jsons=R;break;case y.TransferClient:var _=l(w);v(_.transferKey,_.address);break;case y.ConnectionResponse:return void m(f(w))}return n.saveSnapshot(E),E}},function(t,e,n){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var r=n(62),i=n(63),o=n(64);function s(){return p.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,e){if(s()<e)throw new RangeError("Invalid typed array length");return p.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=p.prototype:(null===t&&(t=new p(e)),t.length=e),t}function p(t,e,n){if(!(p.TYPED_ARRAY_SUPPORT||this instanceof p))return new p(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return u(this,t)}return c(this,t,e,n)}function c(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);p.TYPED_ARRAY_SUPPORT?(t=e).__proto__=p.prototype:t=l(t,e);return t}(t,e,n,r):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!p.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|d(e,n),i=(t=a(t,r)).write(e,n);i!==r&&(t=t.slice(0,i));return t}(t,e,n):function(t,e){if(p.isBuffer(e)){var n=0|f(e.length);return 0===(t=a(t,n)).length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||function(t){return t!=t}(e.length)?a(t,0):l(t,e);if("Buffer"===e.type&&o(e.data))return l(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function h(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function u(t,e){if(h(e),t=a(t,e<0?0:0|f(e)),!p.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function l(t,e){var n=e.length<0?0:0|f(e.length);t=a(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function f(t){if(t>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|t}function d(t,e){if(p.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return F(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return j(t).length;default:if(r)return F(t).length;e=(""+e).toLowerCase(),r=!0}}function y(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function g(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=p.from(e,r)),p.isBuffer(e))return 0===e.length?-1:m(t,e,n,r,i);if("number"==typeof e)return e&=255,p.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):m(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function m(t,e,n,r,i){var o,s=1,a=t.length,p=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,a/=2,p/=2,n/=2}function c(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){var h=-1;for(o=n;o<a;o++)if(c(t,o)===c(e,-1===h?0:o-h)){if(-1===h&&(h=o),o-h+1===p)return h*s}else-1!==h&&(o-=o-h),h=-1}else for(n+p>a&&(n=a-p),o=n;o>=0;o--){for(var u=!0,l=0;l<p;l++)if(c(t,o+l)!==c(e,l)){u=!1;break}if(u)return o}return-1}function v(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var s=0;s<r;++s){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))return s;t[n+s]=a}return s}function I(t,e,n,r){return z(F(e,t.length-n),t,n,r)}function w(t,e,n,r){return z(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function E(t,e,n,r){return w(t,e,n,r)}function b(t,e,n,r){return z(j(e),t,n,r)}function U(t,e,n,r){return z(function(t,e){for(var n,r,i,o=[],s=0;s<t.length&&!((e-=2)<0);++s)n=t.charCodeAt(s),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(e,t.length-n),t,n,r)}function x(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function P(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var o,s,a,p,c=t[i],h=null,u=c>239?4:c>223?3:c>191?2:1;if(i+u<=n)switch(u){case 1:c<128&&(h=c);break;case 2:128==(192&(o=t[i+1]))&&(p=(31&c)<<6|63&o)>127&&(h=p);break;case 3:o=t[i+1],s=t[i+2],128==(192&o)&&128==(192&s)&&(p=(15&c)<<12|(63&o)<<6|63&s)>2047&&(p<55296||p>57343)&&(h=p);break;case 4:o=t[i+1],s=t[i+2],a=t[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(p=(15&c)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&p<1114112&&(h=p)}null===h?(h=65533,u=1):h>65535&&(h-=65536,r.push(h>>>10&1023|55296),h=56320|1023&h),r.push(h),i+=u}return function(t){var e=t.length;if(e<=k)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=k));return n}(r)}e.Buffer=p,e.SlowBuffer=function(t){+t!=t&&(t=0);return p.alloc(+t)},e.INSPECT_MAX_BYTES=50,p.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=s(),p.poolSize=8192,p._augment=function(t){return t.__proto__=p.prototype,t},p.from=function(t,e,n){return c(null,t,e,n)},p.TYPED_ARRAY_SUPPORT&&(p.prototype.__proto__=Uint8Array.prototype,p.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&p[Symbol.species]===p&&Object.defineProperty(p,Symbol.species,{value:null,configurable:!0})),p.alloc=function(t,e,n){return function(t,e,n,r){return h(e),e<=0?a(t,e):void 0!==n?"string"==typeof r?a(t,e).fill(n,r):a(t,e).fill(n):a(t,e)}(null,t,e,n)},p.allocUnsafe=function(t){return u(null,t)},p.allocUnsafeSlow=function(t){return u(null,t)},p.isBuffer=function(t){return!(null==t||!t._isBuffer)},p.compare=function(t,e){if(!p.isBuffer(t)||!p.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},p.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},p.concat=function(t,e){if(!o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return p.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=p.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var s=t[n];if(!p.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,i),i+=s.length}return r},p.byteLength=d,p.prototype._isBuffer=!0,p.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)y(this,e,e+1);return this},p.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)y(this,e,e+3),y(this,e+1,e+2);return this},p.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)y(this,e,e+7),y(this,e+1,e+6),y(this,e+2,e+5),y(this,e+3,e+4);return this},p.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?P(this,0,t):function(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return T(this,e,n);case"utf8":case"utf-8":return P(this,e,n);case"ascii":return C(this,e,n);case"latin1":case"binary":return B(this,e,n);case"base64":return x(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}.apply(this,arguments)},p.prototype.equals=function(t){if(!p.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===p.compare(this,t)},p.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},p.prototype.compare=function(t,e,n,r,i){if(!p.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(e>>>=0,n>>>=0,r>>>=0,i>>>=0,this===t)return 0;for(var o=i-r,s=n-e,a=Math.min(o,s),c=this.slice(r,i),h=t.slice(e,n),u=0;u<a;++u)if(c[u]!==h[u]){o=c[u],s=h[u];break}return o<s?-1:s<o?1:0},p.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},p.prototype.indexOf=function(t,e,n){return g(this,t,e,n,!0)},p.prototype.lastIndexOf=function(t,e,n){return g(this,t,e,n,!1)},p.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return v(this,t,e,n);case"utf8":case"utf-8":return I(this,t,e,n);case"ascii":return w(this,t,e,n);case"latin1":case"binary":return E(this,t,e,n);case"base64":return b(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},p.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var k=4096;function C(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function B(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function T(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=e;o<n;++o)i+=L(t[o]);return i}function A(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function R(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function _(t,e,n,r,i,o){if(!p.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function S(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-n,2);i<o;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function Y(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-n,4);i<o;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function M(t,e,n,r,i,o){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function D(t,e,n,r,o){return o||M(t,0,n,4),i.write(t,e,n,r,23,4),n+4}function O(t,e,n,r,o){return o||M(t,0,n,8),i.write(t,e,n,r,52,8),n+8}p.prototype.slice=function(t,e){var n,r=this.length;if(t=~~t,e=void 0===e?r:~~e,t<0?(t+=r)<0&&(t=0):t>r&&(t=r),e<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),p.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=p.prototype;else{var i=e-t;n=new p(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+t]}return n},p.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||R(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},p.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||R(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},p.prototype.readUInt8=function(t,e){return e||R(t,1,this.length),this[t]},p.prototype.readUInt16LE=function(t,e){return e||R(t,2,this.length),this[t]|this[t+1]<<8},p.prototype.readUInt16BE=function(t,e){return e||R(t,2,this.length),this[t]<<8|this[t+1]},p.prototype.readUInt32LE=function(t,e){return e||R(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},p.prototype.readUInt32BE=function(t,e){return e||R(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},p.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||R(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},p.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||R(t,e,this.length);for(var r=e,i=1,o=this[t+--r];r>0&&(i*=256);)o+=this[t+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},p.prototype.readInt8=function(t,e){return e||R(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},p.prototype.readInt16LE=function(t,e){e||R(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},p.prototype.readInt16BE=function(t,e){e||R(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},p.prototype.readInt32LE=function(t,e){return e||R(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},p.prototype.readInt32BE=function(t,e){return e||R(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},p.prototype.readFloatLE=function(t,e){return e||R(t,4,this.length),i.read(this,t,!0,23,4)},p.prototype.readFloatBE=function(t,e){return e||R(t,4,this.length),i.read(this,t,!1,23,4)},p.prototype.readDoubleLE=function(t,e){return e||R(t,8,this.length),i.read(this,t,!0,52,8)},p.prototype.readDoubleBE=function(t,e){return e||R(t,8,this.length),i.read(this,t,!1,52,8)},p.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||_(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},p.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||_(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+n},p.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||_(this,t,e,1,255,0),p.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},p.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||_(this,t,e,2,65535,0),p.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):S(this,t,e,!0),e+2},p.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||_(this,t,e,2,65535,0),p.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):S(this,t,e,!1),e+2},p.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||_(this,t,e,4,4294967295,0),p.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):Y(this,t,e,!0),e+4},p.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||_(this,t,e,4,4294967295,0),p.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):Y(this,t,e,!1),e+4},p.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);_(this,t,e,n,i-1,-i)}var o=0,s=1,a=0;for(this[e]=255&t;++o<n&&(s*=256);)t<0&&0===a&&0!==this[e+o-1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n},p.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);_(this,t,e,n,i-1,-i)}var o=n-1,s=1,a=0;for(this[e+o]=255&t;--o>=0&&(s*=256);)t<0&&0===a&&0!==this[e+o+1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n},p.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||_(this,t,e,1,127,-128),p.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},p.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||_(this,t,e,2,32767,-32768),p.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):S(this,t,e,!0),e+2},p.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||_(this,t,e,2,32767,-32768),p.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):S(this,t,e,!1),e+2},p.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||_(this,t,e,4,2147483647,-2147483648),p.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):Y(this,t,e,!0),e+4},p.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||_(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),p.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):Y(this,t,e,!1),e+4},p.prototype.writeFloatLE=function(t,e,n){return D(this,t,e,!0,n)},p.prototype.writeFloatBE=function(t,e,n){return D(this,t,e,!1,n)},p.prototype.writeDoubleLE=function(t,e,n){return O(this,t,e,!0,n)},p.prototype.writeDoubleBE=function(t,e,n){return O(this,t,e,!1,n)},p.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,o=r-n;if(this===t&&n<e&&e<r)for(i=o-1;i>=0;--i)t[i+e]=this[i+n];else if(o<1e3||!p.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),e);return o},p.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!p.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{var s=p.isBuffer(t)?t:F(new p(t,r).toString()),a=s.length;for(o=0;o<n-e;++o)this[o+e]=s[o%a]}return this};var N=/[^+\/0-9A-Za-z-_]/g;function L(t){return t<16?"0"+t.toString(16):t.toString(16)}function F(t,e){var n;e=e||1/0;for(var r=t.length,i=null,o=[],s=0;s<r;++s){if((n=t.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function j(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(N,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function z(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}}).call(e,n(61))},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";e.byteLength=function(t){var e=c(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){for(var e,n=c(t),r=n[0],s=n[1],a=new o(function(t,e,n){return 3*(e+n)/4-n}(0,r,s)),p=0,h=s>0?r-4:r,u=0;u<h;u+=4)e=i[t.charCodeAt(u)]<<18|i[t.charCodeAt(u+1)]<<12|i[t.charCodeAt(u+2)]<<6|i[t.charCodeAt(u+3)],a[p++]=e>>16&255,a[p++]=e>>8&255,a[p++]=255&e;2===s&&(e=i[t.charCodeAt(u)]<<2|i[t.charCodeAt(u+1)]>>4,a[p++]=255&e);1===s&&(e=i[t.charCodeAt(u)]<<10|i[t.charCodeAt(u+1)]<<4|i[t.charCodeAt(u+2)]>>2,a[p++]=e>>8&255,a[p++]=255&e);return a},e.fromByteArray=function(t){for(var e,n=t.length,i=n%3,o=[],s=0,a=n-i;s<a;s+=16383)o.push(u(t,s,s+16383>a?a:s+16383));1===i?(e=t[n-1],o.push(r[e>>2]+r[e<<4&63]+"==")):2===i&&(e=(t[n-2]<<8)+t[n-1],o.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"="));return o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,p=s.length;a<p;++a)r[a]=s[a],i[s.charCodeAt(a)]=a;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function h(t){return r[t>>18&63]+r[t>>12&63]+r[t>>6&63]+r[63&t]}function u(t,e,n){for(var r,i=[],o=e;o<n;o+=3)r=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(255&t[o+2]),i.push(h(r));return i.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,r,i){var o,s,a=8*i-r-1,p=(1<<a)-1,c=p>>1,h=-7,u=n?i-1:0,l=n?-1:1,f=t[e+u];for(u+=l,o=f&(1<<-h)-1,f>>=-h,h+=a;h>0;o=256*o+t[e+u],u+=l,h-=8);for(s=o&(1<<-h)-1,o>>=-h,h+=r;h>0;s=256*s+t[e+u],u+=l,h-=8);if(0===o)o=1-c;else{if(o===p)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,r),o-=c}return(f?-1:1)*s*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var s,a,p,c=8*o-i-1,h=(1<<c)-1,u=h>>1,l=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,d=r?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=h):(s=Math.floor(Math.log(e)/Math.LN2),e*(p=Math.pow(2,-s))<1&&(s--,p*=2),(e+=s+u>=1?l/p:l*Math.pow(2,1-u))*p>=2&&(s++,p/=2),s+u>=h?(a=0,s=h):s+u>=1?(a=(e*p-1)*Math.pow(2,i),s+=u):(a=e*Math.pow(2,u-1)*Math.pow(2,i),s=0));i>=8;t[n+f]=255&a,f+=d,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;t[n+f]=255&s,f+=d,s/=256,c-=8);t[n+f-d]|=128*y}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){var r=n(1),i=n(0),o=n(66);t.exports=function(t,e){for(var n=t[i[r.UInt16].read](),s=[],a=0;a<n;a++){var p=o(t,e);s.push(p)}return s}},function(t,e,n){var r=n(0);t.exports=function(t,e,n){var i={},o=t[r[n.ID_BINARY_TYPE].read](),s=e.getEntity(o).protocol;return i.id=o,i.updates=[],s.batch.keys.forEach(e=>{var n=s.batch.properties[e],o=t[r[n.type].read]();i.updates.push({isDelta:n.delta,prop:e,path:n.path,value:o})}),i}},function(t,e,n){var r=n(1),i=n(0),o=n(68);t.exports=function(t,e,n){for(var s=t[i[r.UInt16].read](),a=[],p=0;p<s;p++){var c=o(t,e,n);a.push(c)}return a}},function(t,e,n){var r=n(0),i=n(18);t.exports=function(t,e,n){var o=t[r[n.ID_BINARY_TYPE].read](),s=e.getEntity(o).protocol,a=t[r[s.keyType].read](),p=s.keys[a],c=s.properties[p],h=i(t,c.type,c.arrayIndexType);return{id:o,prop:p,path:c.path,value:h}}},function(t,e,n){var r=n(1),i=n(0),o=n(9);t.exports=function(t,e,n){for(var s=t[i[r.UInt16].read](),a=[],p=0;p<s;p++){var c=t[i[n.TYPE_BINARY_TYPE].read](),h=e.getProtocol(c),u=o(t,h,1,c,n.TYPE_PROPERTY_NAME);u.protocol=h,a.push(u)}return a}},function(t,e,n){n(4).Chunk;var r=n(1),i=n(0);t.exports=function(t,e){for(var n=[],o=t[i[r.UInt16].read](),s=0;s<o;s++){var a=t[i[e.ID_BINARY_TYPE].read]();n.push(a)}return n}},function(t,e,n){var r=n(1),i=n(0),o=n(9);t.exports=function(t,e,n){for(var s=t[i[r.UInt8].read](),a=[],p=0;p<s;p++){var c=t[i[n.TYPE_BINARY_TYPE].read](),h=e.getProtocol(c),u=o(t,h,1,c,n.TYPE_PROPERTY_NAME);u.protocol=h,a.push(u)}return a}},function(t,e,n){var r=n(1),i=n(0),o=n(9);t.exports=function(t,e,n){for(var s=t[i[r.UInt16].read](),a=[],p=0;p<s;p++){var c=t[i[n.TYPE_BINARY_TYPE].read](),h=e.getProtocol(c),u=o(t,h,1,c,n.TYPE_PROPERTY_NAME);u.protocol=h,a.push(u)}return a}},function(t,e,n){var r=n(1),i=n(0),o=n(74);t.exports=function(t){for(var e=t[i[r.UInt16].read](),n=[],s=0;s<e;s++){var a=o(t);n.push(a)}return n}},function(t,e,n){var r=n(13);t.exports=function(t){for(var e=t.readUInt32(),n="",i=0;i<e;i++)n+=String.fromCharCode(t.readUInt8());return r.decode(n)}},function(t,e,n){var r=n(1),i=n(0);t.exports=function(t){return{time:t[i[r.Float64].read](),avgLatency:t[i[r.UInt9].read]()}}},function(t,e,n){var r=n(1),i=n(0);t.exports=function(t){return t[i[r.UInt8].read]()}},function(t,e,n){var r=n(1),i=n(0);t.exports=function(t){return{transferKey:i[r.UTF8String].read(t),address:i[r.UTF8String].read(t)}}},function(t,e,n){var r=n(1),i=n(0);t.exports=function(t){return{accepted:t.readBoolean(),text:i[r.UTF8String].read(t)}}},function(t,e,n){var r=n(1),i=n(0),o=n(9);t.exports=function(t,e,n){for(var s=t[i[r.UInt16].read](),a=[],p=0;p<s;p++){var c=t[i[n.TYPE_BINARY_TYPE].read](),h=e.getMetaProtocol(c),u=o(t,h,1,c,n.TYPE_PROPERTY_NAME);u.protocol=h,a.push(u)}return a}},function(t,e,n){var r=n(7),i=n(8),o=n(4).Chunk,s=n(81),a=n(84);t.exports=function(t,e){var n=0;n+=8,n+=32,n+=s(e);var p=new r(n),c=new i(p);return c.writeUInt8(o.ClientTick),c.writeUInt32(t),a(c,e),p}},function(t,e,n){var r=n(1),i=n(0),o=n(82);t.exports=function(t){var e=0;e+=i[r.UInt8].bits,e+=i[r.UInt16].bits;for(var n=0;n<t.length;n++){var s=t[n];e+=o(s,s.protocol)}return e}},function(t,e,n){var r=n(0),i=n(83);t.exports=function t(e,n,o){if(!n)throw new Error("Protocol error: nengi encountered a Message without a protocol (did you mean to try to send this object? did you remember to add its protocol to the config?). Data:"+JSON.stringify(e));for(var s=0,a=0;a<n.keys.length;a++){var p=n.keys[a],c=n.properties[p],h=e[p];if(c.protocol&&c.isArray){s+=r[c.arrayIndexType].bits;for(var u=0;u<h.length;u++)s+=t(h[u],c.protocol)}else if(c.protocol)s+=t(h,c.protocol);else if(c.isArray)for(s+=r[c.arrayIndexType].bits,u=0;u<h.length;u++)s+=i(c.type,c.arrayIndexType,h[u]);else s+=i(c.type,c.arrayIndexType,h)}return s}},function(t,e,n){var r=n(0);n(1);t.exports=function(t,e,n){var i=r[t];return i.countBits?i.countBits(n):i.bits}},function(t,e,n){var r=n(4).Chunk,i=n(1),o=n(0),s=n(85);t.exports=function(t,e){t[o[i.UInt8].write](r.Commands),t[o[i.UInt16].write](e.length);for(var n=0;n<e.length;n++){var a=e[n];s(t,a,a.protocol)}}},function(t,e,n){var r=n(0),i=n(86),o=n(6),s=function(t,e,n,a){for(var p=0;p<n.keys.length;p++){var c=n.keys[p],h=n.properties[c],u=o(e,h.path);if(h.protocol&&h.isArray){t[r[h.arrayIndexType].write](u.length);for(var l=0;l<u.length;l++)s(t,u[l],h.protocol)}else if(h.protocol)s(t,u,h.protocol);else if(h.isArray){t[r[h.arrayIndexType].write](u.length);for(l=0;l<u.length;l++)i(t,h.type,h.arrayIndexType,u[l])}else i(t,h.type,h.arrayIndexType,u)}};t.exports=s},function(t,e,n){var r=n(0);n(1);t.exports=function(t,e,n,i){var o=r[e];o.customWrite?o.write(t,i):t[o.write](i)}},function(t,e,n){var r=n(7),i=n(8),o=n(4).Chunk;n(88),n(89);t.exports=function(t){var e=0;e+=8;var n=new r(e+=8),s=new i(n);return s.writeUInt8(o.Pong),s.writeUInt8(t),n}},function(t,e,n){var r=n(1),i=n(0);t.exports=function(t){var e=0;return t>-1&&(e+=i[r.UInt8].bits,e+=i[r.UInt8].bits),e}},function(t,e,n){var r=n(4).Chunk,i=n(1),o=n(0);t.exports=function(t,e){e>-1&&(t[o[i.UInt8].write](r.Pong),t[o[i.UInt8].write](e))}},function(t,e,n){var r=n(7),i=n(8),o=n(0),s=n(1),a=n(4).Chunk;t.exports=function(t){var e=JSON.stringify(t),n=8;n+=o[s.UTF8String].countBits(e);var p=new r(n),c=new i(p);return c.writeUInt8(a.Handshake),o[s.UTF8String].write(c,e),p}},function(t,e,n){var r=n(6),i=n(10),o=function(t,e){for(var n={},s=0;s<e.keys.length;s++){var a=e.properties[e.keys[s]],p=r(t,a.path);if(a.isArray)if(a.protocol){for(var c=[],h=0;h<p.length;h++)c.push(o(p[h],a.protocol));p=c}else{for(c=[],h=0;h<p.length;h++)c.push(p[h]);p=c}else void 0!==a.protocol&&null!==a.protocol&&(p=o(p,a.protocol));void 0===p&&(p=0),i(n,a.path,p)}return n};t.exports=o},function(t,e,n){var r=n(93),i=n(20),o=n(6),s=n(10);function a(t,e,n,i){this.timeBetweenSnapshots=e,this.tick=t,this.clientTick=n.clientTick,this.raw=n,this.processed=!1,this.timestamp=n.timestamp,this.entities=new r,this.components=new r,this.noInterps=[],this.createEntities=[],this.updateEntities=[],this.deleteEntities=[],this.createComponents=[],this.updateComponents=[],this.deleteComponents=[],this.localMessages=[],this.messages=[],this.jsons=[],this.ping=-1,this.init(n,i)}a.prototype.init=function(t,e){e&&(-1===this.timestamp&&(this.timestamp=e.timestamp+this.timeBetweenSnapshots),e.entities.forEach(t=>{var e=i(t,t.protocol);e.protocol=t.protocol,this.entities.add(e)}),e.components.forEach(t=>{var e=i(t,t.protocol);e.protocol=t.protocol,this.components.add(e)})),t.engineMessages.forEach(t=>{this.noInterps=t.ids}),t.createEntities.forEach(t=>{var e=i(t,t.protocol);e.protocol=t.protocol,this.entities.add(e),this.createEntities.push(e)}),t.createComponents.forEach(t=>{var e=i(t,t.protocol);e.protocol=t.protocol,this.components.add(e),this.createComponents.push(e)}),t.localMessages.forEach(t=>{var e=i(t,t.protocol);e.protocol=t.protocol,this.localMessages.push(e)}),t.messages.forEach(t=>{var e=i(t,t.protocol);e.protocol=t.protocol,this.messages.push(e)}),t.jsons.forEach(t=>{this.jsons.push(JSON.parse(t))}),t.updateEntities.partial.forEach(t=>{var e=this.entities.get(t.id);s(e,t.path,t.value),this.updateEntities.push({id:t.id,prop:t.prop,path:t.path,value:t.value})}),t.updateEntities.optimized.forEach(t=>{var e=this.entities.get(t.id);t.updates.forEach(n=>{if(n.isDelta){var r=o(e,n.path);s(e,n.path,r+n.value)}else s(e,n.path,n.value);this.updateEntities.push({id:t.id,prop:n.prop,path:n.path,value:e[n.prop]})})}),t.deleteEntities.forEach(t=>{this.deleteEntities.push(t),this.entities.removeById(t)}),t.updateComponents.partial.forEach(t=>{var e=this.components.get(t.id);s(e,t.path,t.value),this.updateComponents.push({id:t.id,prop:t.prop,path:t.path,value:t.value})}),t.deleteComponents.forEach(t=>{this.deleteComponents.push(t),this.components.removeById(t)})},t.exports=a},function(t,e){function n(){this.object={},this.array=[]}n.prototype.get=function(t){return void 0!==this.object[t]?this.object[t]:null},n.prototype.forEach=function(t){for(var e=0;e<this.array.length;e++)t(this.array[e])},n.prototype.toArray=function(){return this.array.slice()},n.prototype.add=function(t){if("object"!=typeof t||void 0===t.id)throw new Error("EDictionary could not add object, invalid object or object.id.");this.object[t.id]=t,this.array.push(t)},n.prototype.remove=function(t){if("object"==typeof t&&void 0!==t.id)return this.removeById(t.id)},n.prototype.removeById=function(t){if(void 0!==t){for(var e=-1,n=0;n<this.array.length;n++)if(this.array[n].id===t){e=n;break}-1!==e&&this.array.splice(e,1);var r=this.object[t];return delete this.object[t],r}},t.exports=n},function(t,e,n){const r=n(95);t.exports={messages:[["NoInterps",r.protocol,66]]}},function(t,e,n){var r=n(1);class i{constructor(t){this.type=66,this.ids=t}}i.protocol={ids:{type:r.UInt32,indexType:r.UInt32}},t.exports=i},function(t,e,n){const r=n(19),i=n(6),o=n(0),s=function(t,e){for(var n=t.length-1;n>=0;n--){var r=t[n];if(r.timestamp<e)return{snapshot:r,index:n}}},a=function(t,e,n){return t+(e-t)*n};t.exports=class{constructor(t){this.cache=new r,this.interpDelay=t,this.lastProcessedTick=-1}interpolate(t,e,n){var r=Date.now()-this.interpDelay-n,p=[],c=null,h=null,u=s(t,r);if(u&&(h=u.snapshot,u.index),h){for(var l=h.tick,f=0;f<t.length;f++){var d=t[f];d.tick===l+1&&(c=d)}var y={createEntities:[],deleteEntities:[],updateEntities:[],createComponents:[],deleteComponents:[],updateComponents:[],tick:null};if(h.tick-1>this.lastProcessedTick)for(f=t.length-1;f>-1;f--){var g=t[f];g.tick<h.tick&&!g.processed&&(p.push(g),g.processed=!0,t.splice(f,1))}if(p.reverse(),!h.processed){for(y.timestamp=h.timestamp,y.createEntities=y.createEntities.concat(h.createEntities),y.deleteEntities=y.deleteEntities.concat(h.deleteEntities),y.createComponents=y.createComponents.concat(h.createComponents),y.deleteComponents=y.deleteComponents.concat(h.deleteComponents),y.updateEntities=y.updateEntities.concat(h.updateEntities),h.processed=!0,y.tick=h.tick,this.lastProcessedTick=h.tick,f=0;f<y.createEntities.length;f++)this.cache.saveEntity(y.createEntities[f],y.createEntities[f].protocol);for(f=0;f<y.deleteEntities.length;f++)this.cache.deleteEntity(y.deleteEntities[f]);for(f=0;f<y.createComponents.length;f++)this.cache.saveEntity(y.createComponents[f],y.createComponents[f].protocol);for(f=0;f<y.updateEntities.length;f++)this.cache.updateEntityPartial(y.updateEntities[f].id,y.updateEntities[f].path,y.updateEntities[f].value)}}if(c&&h&&h.tick>=this.lastProcessedTick){var m=e,v=(r-h.timestamp)/m;y.timestamp=a(h.timestamp,c.timestamp,v);var I=[];for(f=0;f<c.updateEntities.length;f++){var w=c.updateEntities[f];I.push(w.id);var E=w.prop,b=(B=h.entities.get(w.id)).protocol.properties[E],U=o[b.type];if(b.interp&&-1===c.noInterps.indexOf(w.id)){var x=c.entities.get(w.id),P=i(B,b.path),k=i(x,b.path),C=P;(C="function"==typeof U.interp?U.interp(P,k,v):a(P,k,v))!==i(this.cache.getEntity(w.id),b.path)&&y.updateEntities.push({id:w.id,prop:E,path:b.path,value:C})}else w.value!==i(this.cache.getEntity(w.id),w.path)&&y.updateEntities.push(w)}for(f=0;f<h.updateEntities.length;f++)w=h.updateEntities[f],-1===I.indexOf(w.id)&&w.value!==i(this.cache.getEntity(w.id),w.path)&&y.updateEntities.push(w);for(I=[],f=0;f<c.updateComponents.length;f++){w=c.updateComponents[f],I.push(w.id);var B=h.components.get(w.id);E=w.prop,b=B.protocol.properties[E],U=o[b.type],b.interp&&-1===c.noInterps.indexOf(w.id)?(x=c.components.get(w.id),P=i(B,b.path),k=i(x,b.path),C=P,(C="function"==typeof U.interp?U.interp(P,k,v):a(P,k,v))!==i(this.cache.getEntity(w.id),b.path)&&y.updateComponents.push({id:w.id,prop:E,path:b.path,value:C})):w.value!==i(this.cache.getEntity(w.id),w.path)&&y.updateComponents.push(w)}for(f=0;f<h.updateComponents.length;f++)w=h.updateComponents[f],-1===I.indexOf(w.id)&&w.value!==i(this.cache.getEntity(w.id),w.path)&&y.updateComponents.push(w)}if(y){for(f=0;f<y.updateEntities.length;f++)this.cache.updateEntityPartial(y.updateEntities[f].id,y.updateEntities[f].path,y.updateEntities[f].value);for(f=0;f<y.updateComponents.length;f++)this.cache.updateEntityPartial(y.updateComponents[f].id,y.updateComponents[f].path,y.updateComponents[f].value);for(f=0;f<y.deleteComponents.length;f++)this.cache.deleteEntity(y.deleteComponents[f])}return y&&p.push(y),{entities:p,interpA:h,interpB:c}}}},function(t,e,n){const r=n(3);var i={UPDATE_RATE:20,DRAW_RATE:60,ID_BINARY_TYPE:r.UInt16,TYPE_BINARY_TYPE:r.UInt8,ID_PROPERTY_NAME:"id",PARENT_ID_PROPERTY_NAME:"parentId",TYPE_PROPERTY_NAME:"type",protocols:{entities:[["TestUser",n(21)]],localMessages:[["Signal",n(98)],["PlayerDeadLocalMessage",n(99)]],messages:[["Identity",n(100)],["TestMessage",n(101)],["TestLocalMessage",n(102)]],commands:[["TestCommand",n(103)],["MoveCommand",n(22)],["PlayerDeadCommand",n(23)]],basics:[]}};t.exports=i},function(t,e,n){const r=n(3);class i{constructor(t,e,n){this.x=0,this.y=0,this.REQUIRE_SNAPSHOT=n,void 0===this.REQUIRE_SNAPSHOT&&(this.REQUIRE_SNAPSHOT=!1)}}i.protocol={x:r.Float32,y:r.Float32,REQUIRE_SNAPSHOT:r.Boolean},t.exports=i},function(t,e,n){const r=n(3);class i{constructor(t,e,n,r){this.x=t,this.y=e,this.id=n,this.killedId=r}}i.protocol={x:r.UInt16,y:r.UInt16,id:r.UInt16,killedId:r.UInt16},t.exports=i},function(t,e,n){const r=n(3);class i{constructor(t){this.entityId=t}}i.protocol={entityId:r.UInt16},t.exports=i},function(t,e,n){const r=n(3);class i{constructor(t){this.message=t}}i.protocol={message:r.String},t.exports=i},function(t,e,n){const r=n(3);class i{constructor(t){this.message=t}}i.protocol={message:r.String},t.exports=i},function(t,e,n){const r=n(3);class i{constructor(t){this.message=t}}i.protocol={message:r.String},t.exports=i},function(t,e,n){const r=n(21),i=n(22),o=n(23);t.exports=class{constructor(t,e){this.gameClient=t,this.gameObject=e}createEntity(t){if("TestUser"===t.protocol.name&&t.id!==this.gameObject.player.name){let e=new r(t.x,t.y);this.gameObject.createPlayer(t.id,e)}}updateEntities(t,e){let n=this.gameObject.players.getByName(t.id);t.id===this.gameObject.player.name&&null==this.gameObject.players.getByName(t.id)||("anim"===t.prop?n.setData("anim",t.value):"kill"===t.prop?(n.setData("kill",t.value),console.log(t)):this.gameObject.updateOtherPlayer(n,t,e))}deleteEntities(t){void 0!==this.gameObject.players.getByName(t)&&this.gameObject.destroyQueue.push(t)}processMessage(t){"Identity"===t.protocol.name&&(this.gameObject.player.name=t.entityId)}processLocalMessage(t){"Signal"===t.protocol.name?!0===t.REQUIRE_SNAPSHOT&&(this.gameClient.client.addCommand(new i(this.gameObject.player.x+1,this.gameObject.player.y+1,this.gameObject.player.getByName("body").getData("anim"))),this.gameClient.client.update()):"PlayerDeadLocalMessage"===t.protocol.name&&t.id!==this.gameObject.player.name&&this.gameObject.destroyQueue.push(t.killedId)}sendPlayerDeadCommand(t,e){this.gameClient.client.addCommand(new o(t,e)),this.gameClient.client.update()}processUpdate(){this.gameClient.client.addCommand(new i(this.gameObject.player.x,this.gameObject.player.y,this.gameObject.player.getData("anim"),this.gameObject.player.getData("kill"))),this.gameClient.client.update()}}},function(t,e){t.exports=class{constructor(t){this.gameClient,this.scene=t,this.objectEvent=new Phaser.Events.EventEmitter,this.players=this.scene.add.container(0,0),this.destroyQueue=new Array,this.devil=this.scene.physics.add.sprite(0,0,"body"),this.sword=this.scene.physics.add.sprite(0,0,"sword").setOrigin(.18,.5),this.hole=this.scene.physics.add.sprite(0,64,"hole").setCircle(16).setScale(2).setAngularVelocity(720),this.devil.setName("body"),this.sword.setName("sword"),this.hole.setName("hole");var e=Phaser.Geom.Rectangle.Inflate(Phaser.Geom.Rectangle.Clone(this.scene.physics.world.bounds),-100,-100),n=Phaser.Geom.Rectangle.Random(e);this.player=this.scene.add.container(n.x,n.y),this.player.add([this.devil,this.sword,this.hole]),this.player.setSize(32,32),this.scene.physics.world.enable(this.player),this.player.body.setCollideWorldBounds(!0),this.scene.cameras.main.startFollow(this.player.body,!0,.05,.05),this.player.setData("kill",2)}createPlayer(t,e){let n,r=this.scene.physics.add.sprite(0,0,"body");r.setData("anim",e.anim),n=2+.2*e.kill<=10?2+.5*e.kill:10;let i=this.scene.physics.add.sprite(0,0,"sword").setOrigin(.18,.5),o=this.scene.physics.add.sprite(0,64+32*n,"hole").setCircle(16).setScale(n).setAngularVelocity(720),s=this.scene.add.container(e.x,e.y);r.setName("body"),i.originY=0,i.setName("sword"),o.setName("hole"),s.add([r,i,o]),s.setData("kill",e.kill),s.setName(t),s.setSize(32,32),this.scene.physics.world.enable(s),s.body.setCollideWorldBounds(!0),this.players.add(s),this.interactiveEventRegister(s)}updateOtherPlayer(t,e,n){if(void 0!=typeof t&&void 0!=this.player){var r=t.getByName("hole"),i=t.getByName("sword");i.setOrigin(.18,.5);var o,s=e.prop,a=e.value,p=this.players.getByName(e.id).getData("kill");o=2+.2*p<=10?2+.2*p:10,r.scale=o,"x"===s?t.x<a?(t.getByName("body").setData("anim",1),this.scene.tweens.add({targets:[i],angle:0,ease:"Sine.In",duration:n,repeat:0}),r.x=32*o+64,r.y=0):t.x>a&&(t.getByName("body").setData("anim",3),this.scene.tweens.add({targets:[i],angle:180,ease:"Sine.In",duration:n,repeat:0}),r.x=-(32*o+64),r.y=0):"y"===s&&(t.y<a?(t.getByName("body").setData("anim",2),this.scene.tweens.add({targets:[i],angle:90,ease:"Sine.In",duration:n,repeat:0}),r.x=0,r.y=64+32*o):t.y>a&&(t.getByName("body").setData("anim",0),this.scene.tweens.add({targets:[i],angle:270,ease:"Sine.In",duration:n,repeat:0}),r.x=0,r.y=-(64+32*o))),this.scene.tweens.add({targets:t,[s]:a,ease:"Sine.In",duration:n,repeat:0})}}destroyPlayer(){for(;0!==this.destroyQueue.length;){let t,e=this.destroyQueue.shift();void 0!==this.players.getByName(e)&&null!==this.players.getByName(e)&&(this.players.remove(t),this.players.getByName(e).destroy())}}interactiveEventRegister(t){this.overlapEachOtherEvent(t)}overlapEachOtherEvent(t){var e=this.player.getByName("hole"),n=t.getByName("body"),r=t.getByName("hole"),i=this.player.getByName("body");this.scene.physics.add.overlap(n,e,t=>{this.destroyQueue.push(n.parentContainer.name),this.scene.score+=1,this.scene.scoreText.setText("score: "+this.scene.score)}),this.scene.physics.add.overlap(i,r,(t,e)=>{let n=e.parentContainer.name,r=this.player.name;this.gameClient.clientProcessor.sendPlayerDeadCommand(n,r),this.scene.active=0,this.scene.scene.start("sceneStart")})}}},function(t,e){var n=new Phaser.Class({Extends:Phaser.Scene,initialize:function(){Phaser.Scene.call(this,{key:"sceneStart"})},preload:function(){this.load.image("start","assets/startPic.jpg")},create:function(){this.add.image(400,300,"start"),this.input.once("pointerdown",function(){console.log("i have click the point "),this.scene.start("sceneMain")},this)}});t.exports=n}]);